import{c as z,aH as B,aI as N,h as T,aJ as H,r as g,a as D,o as A,E,B as M,C as l,D as n,I as e,O as d,G as t,U as P,J as r,L as b,W as U,X as _,N as I,ak as R,aj as h,P as q,R as L,Q as y}from"./index-DCcCDLBa.js";import{Q as k}from"./QChip-BQGfdCtY.js";import{Q as $,_ as G}from"./RatingSlider-CK4XLS6A.js";import{Q as F}from"./QPage-BkxBxwOD.js";import{s as S,R as O}from"./index-CICaFLGK.js";import{u as j}from"./use-quasar-BbdR9xAu.js";import"./use-slider-DwIhW6oY.js";import"./selection-BO4drQm1.js";const J='<g><path fill="none" stroke="currentColor" stroke-width="5" stroke-miterlimit="10" d="M58.4,51.7c-0.9-0.9-1.4-2-1.4-2.3s0.5-0.4,1.4-1.4 C70.8,43.8,79.8,30.5,80,15.5H70H30H20c0.2,15,9.2,28.1,21.6,32.3c0.9,0.9,1.4,1.2,1.4,1.5s-0.5,1.6-1.4,2.5 C29.2,56.1,20.2,69.5,20,85.5h10h40h10C79.8,69.5,70.8,55.9,58.4,51.7z"></path><clipPath id="uil-hourglass-clip1"><rect x="15" y="20" width="70" height="25"><animate attributeName="height" from="25" to="0" dur="1s" repeatCount="indefinite" values="25;0;0" keyTimes="0;0.5;1"></animate><animate attributeName="y" from="20" to="45" dur="1s" repeatCount="indefinite" values="20;45;45" keyTimes="0;0.5;1"></animate></rect></clipPath><clipPath id="uil-hourglass-clip2"><rect x="15" y="55" width="70" height="25"><animate attributeName="height" from="0" to="25" dur="1s" repeatCount="indefinite" values="0;25;25" keyTimes="0;0.5;1"></animate><animate attributeName="y" from="80" to="55" dur="1s" repeatCount="indefinite" values="80;55;55" keyTimes="0;0.5;1"></animate></rect></clipPath><path d="M29,23c3.1,11.4,11.3,19.5,21,19.5S67.9,34.4,71,23H29z" clip-path="url(#uil-hourglass-clip1)" fill="currentColor"></path><path d="M71.6,78c-3-11.6-11.5-20-21.5-20s-18.5,8.4-21.5,20H71.6z" clip-path="url(#uil-hourglass-clip2)" fill="currentColor"></path><animateTransform attributeName="transform" type="rotate" from="0 50 50" to="180 50 50" repeatCount="indefinite" dur="1s" values="0 50 50;0 50 50;180 50 50" keyTimes="0;0.7;1"></animateTransform></g>',W=z({name:"QSpinnerHourglass",props:B,setup(v){const{cSize:c,classes:u}=N(v);return()=>T("svg",{class:u.value,width:c.value,height:c.value,viewBox:"0 0 100 100",preserveAspectRatio:"xMidYMid",xmlns:"http://www.w3.org/2000/svg",innerHTML:J})}}),X={class:"page-hero q-mb-lg"},Y={class:"hero-content"},K={key:0,class:"hero-subtitle"},Z={key:0,class:"loading-container"},ee={key:1,class:"form-container"},te={class:"header-content"},ae={class:"header-text"},se={class:"header-title"},oe={class:"form-section"},ie={class:"section-title"},ne={class:"form-grid"},re={class:"form-section"},le={class:"section-title"},ue={class:"ratings-grid"},de={class:"form-section"},ce={class:"section-title"},me={class:"form-section"},pe={class:"meta-info"},he={class:"form-actions"},Ce={__name:"EditStrain",setup(v){const c=H(),u=E(),m=j(),C=c.params.id,a=g(null),p=g(!1),w=D(()=>Object.values(O));A(()=>{const i=S.getStrainById(C);if(!i){m.notify({type:"negative",message:"Sorte nicht gefunden",position:"top"}),u.push("/show");return}a.value={...i,notes:i.notes||""}});const f=i=>i?new Date(i).toLocaleDateString("de-DE",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"Unbekannt",x=async()=>{if(!a.value?.name?.trim()){m.notify({type:"negative",message:"Bitte einen Namen eingeben",position:"top"});return}p.value=!0;try{if(a.value.updatedAt=Date.now(),S.updateStrain(a.value))m.notify({type:"positive",message:`Sorte "${a.value.name}" erfolgreich gespeichert`,icon:"check_circle",position:"top"}),setTimeout(()=>{u.push("/show")},500);else throw new Error("Update failed")}catch{m.notify({type:"negative",message:"Fehler beim Speichern",position:"top"})}finally{p.value=!1}},Q=()=>{u.push("/show")};return(i,s)=>(l(),M(F,{class:"edit-strain-page q-pa-md"},{default:n(()=>[e("div",X,[e("div",Y,[t(r,{name:"edit",size:"48px",color:"amber-6",class:"q-mb-md"}),s[3]||(s[3]=e("h4",{class:"hero-title"},"Sorte bearbeiten",-1)),a.value?(l(),d("p",K,b(a.value.name)+" anpassen",1)):P("",!0)])]),a.value?(l(),d("div",ee,[t(U,{class:"form-card"},{default:n(()=>[t(_,{class:"card-header"},{default:n(()=>[e("div",te,[t(r,{name:"spa",size:"24px",color:"amber-6"}),e("div",ae,[e("div",se,b(a.value.name),1),s[5]||(s[5]=e("div",{class:"header-subtitle"},"Bearbeite die Sorte-Details",-1))])])]),_:1}),t(I),t(_,{class:"card-body"},{default:n(()=>[t($,{onSubmit:R(x,["prevent"]),class:"strain-form"},{default:n(()=>[e("div",oe,[e("div",ie,[t(r,{name:"info",size:"20px",color:"amber-6"}),s[6]||(s[6]=e("span",null,"Grunddaten",-1))]),e("div",ne,[t(h,{modelValue:a.value.name,"onUpdate:modelValue":s[0]||(s[0]=o=>a.value.name=o),label:"Sortenname",filled:"",class:"form-input",rules:[o=>!!o||"Bitte einen Namen eingeben"]},{prepend:n(()=>[t(r,{name:"label",color:"amber-6"})]),_:1},8,["modelValue","rules"]),t(h,{modelValue:a.value.vendor,"onUpdate:modelValue":s[1]||(s[1]=o=>a.value.vendor=o),label:"Hersteller / Dispensary",filled:"",class:"form-input"},{prepend:n(()=>[t(r,{name:"store",color:"amber-6"})]),_:1},8,["modelValue"])])]),e("div",re,[e("div",le,[t(r,{name:"star",size:"20px",color:"amber-6"}),s[7]||(s[7]=e("span",null,"Bewertungen anpassen",-1))]),e("div",ue,[(l(!0),d(q,null,L(w.value,o=>(l(),d("div",{key:o.key,class:"rating-item"},[t(G,{modelValue:a.value[o.key],"onUpdate:modelValue":V=>a.value[o.key]=V,label:o.label,icon:o.icon},null,8,["modelValue","onUpdate:modelValue","label","icon"])]))),128))])]),e("div",de,[e("div",ce,[t(r,{name:"notes",size:"20px",color:"amber-6"}),s[8]||(s[8]=e("span",null,"Notizen",-1))]),t(h,{modelValue:a.value.notes,"onUpdate:modelValue":s[2]||(s[2]=o=>a.value.notes=o),label:"Persönliche Notizen oder Beschreibung...",type:"textarea",filled:"",rows:"3",class:"form-input"},{prepend:n(()=>[t(r,{name:"edit_note",color:"amber-6"})]),_:1},8,["modelValue"])]),e("div",me,[e("div",pe,[t(k,{icon:"schedule",label:`Erstellt: ${f(a.value.createdAt)}`,color:"grey-3","text-color":"grey-8",size:"sm"},null,8,["label"]),t(k,{icon:"update",label:`Aktualisiert: ${f(a.value.updatedAt)}`,color:"grey-3","text-color":"grey-8",size:"sm"},null,8,["label"])])]),e("div",he,[t(y,{flat:"",label:"Abbrechen",color:"grey-7",class:"action-btn cancel-btn",onClick:Q}),t(y,{type:"submit",unelevated:"",color:"amber-6",label:"Änderungen speichern",icon:"save",class:"action-btn submit-btn",loading:p.value},null,8,["loading"])])]),_:1})]),_:1})]),_:1})])):(l(),d("div",Z,[t(W,{size:"50px",color:"green-6"}),s[4]||(s[4]=e("div",{class:"q-mt-md text-grey-7"},"Lade Sorte...",-1))]))]),_:1}))}};export{Ce as default};
