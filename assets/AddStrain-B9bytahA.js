import{r as m,a as S,a2 as z,o as D,w as N,B as V,C as u,D as l,E as A,I as n,G as a,J as r,W as $,X as h,N as L,ak as R,aj as f,O as v,P as y,R as Q,K as M,L as T,Q as w}from"./index-CpW3-iVN.js";import{Q as E,a as F,b as G,c as q}from"./QList-DeJdjSdP.js";import{Q as O}from"./QMenu-CKZ1XmfE.js";import{Q as j,_ as P}from"./RatingSlider-fxbD-m7Q.js";import{Q as H}from"./QPage-0RlQ54zU.js";import{u as J}from"./use-quasar-BPrO0skq.js";import{s as g,R as K,D as W}from"./index-Rq3Ye2ad.js";import"./position-engine-CH0L0J3K.js";import"./selection-Ba8Ytq5U.js";import"./use-slider-DaIPPoS_.js";const X={class:"page-hero q-mb-lg"},Y={class:"hero-content"},Z={class:"form-container"},ee={class:"header-content"},ae={class:"form-section"},te={class:"section-title"},ne={class:"form-grid"},oe={class:"form-section"},se={class:"section-title"},le={class:"ratings-grid"},re={class:"form-section"},ie={class:"section-title"},de={class:"form-actions"},he={__name:"AddStrain",setup(ue){function x(){if(crypto?.randomUUID)return crypto.randomUUID();const s=new Uint8Array(16);return crypto?.getRandomValues(s),s[6]=s[6]&15|64,s[8]=s[8]&63|128,[...s].map(e=>e.toString(16).padStart(2,"0")).join("").replace(/(.{8})(.{4})(.{4})(.{4})(.{12})/,"$1-$2-$3-$4-$5")}const _=A(),c=J(),o=m({...W,id:x(),notes:""}),p=m(!1),i=m([]),d=m(!1),k=S(()=>Object.values(K));z(()=>{}),D(async()=>{await g.loadStrains(),i.value=[]});const U=S(()=>[...new Set(g.strains.map(s=>s.vendor).filter(Boolean))]);function B(s){o.value.vendor=s,d.value=!1}N(()=>o.value.vendor,s=>{const e=(s||"").toLowerCase();e.length>=2?(i.value=U.value.filter(t=>t.toLowerCase().includes(e)),d.value=i.value.length>0):(i.value=[],d.value=!1)});async function I(){if(!o.value.name.trim())return c.notify({type:"negative",message:"Bitte einen Namen eingeben"});p.value=!0;try{o.value.createdAt=Date.now(),o.value.updatedAt=Date.now(),await g.addStrain(o.value),c.notify({type:"positive",message:`Sorte "${o.value.name}" hinzugefügt`}),setTimeout(()=>_.push("/show"),500)}catch(s){console.error("[AddStrain] save error",s),c.notify({type:"negative",message:"Fehler beim Speichern"})}finally{p.value=!1}}function C(){_.push("/show")}return(s,e)=>(u(),V(H,{class:"add-strain-page q-pa-md"},{default:l(()=>[n("div",X,[n("div",Y,[a(r,{name:"add_circle",size:"48px",color:"green-6",class:"q-mb-md"}),e[4]||(e[4]=n("h4",{class:"hero-title"},"Neue Cannabis Sorte",-1)),e[5]||(e[5]=n("p",{class:"hero-subtitle"},"Füge eine neue Sorte zu deiner Sammlung hinzu",-1))])]),n("div",Z,[a($,{class:"form-card"},{default:l(()=>[a(h,{class:"card-header"},{default:l(()=>[n("div",ee,[a(r,{name:"spa",size:"24px",color:"green-6"}),e[6]||(e[6]=n("div",{class:"header-text"},[n("div",{class:"header-title"},"Sorte Details"),n("div",{class:"header-subtitle"},"Gib die grundlegenden Informationen ein")],-1))])]),_:1}),a(L),a(h,{class:"card-body"},{default:l(()=>[a(j,{onSubmit:R(I,["prevent"]),class:"strain-form"},{default:l(()=>[n("div",ae,[n("div",te,[a(r,{name:"info",size:"20px",color:"green-6"}),e[7]||(e[7]=n("span",null,"Grunddaten",-1))]),n("div",ne,[a(f,{modelValue:o.value.name,"onUpdate:modelValue":e[0]||(e[0]=t=>o.value.name=t),modelModifiers:{trim:!0},label:"Sortenname",filled:"",class:"form-input",rules:[t=>!!t||"Bitte einen Namen eingeben"]},{prepend:l(()=>[a(r,{name:"label",color:"green-6"})]),_:1},8,["modelValue","rules"]),a(f,{modelValue:o.value.vendor,"onUpdate:modelValue":e[2]||(e[2]=t=>o.value.vendor=t),label:"Hersteller / Dispensary",filled:"",class:"form-input"},{prepend:l(()=>[a(r,{name:"store",color:"green-6"})]),default:l(()=>[a(O,{modelValue:d.value,"onUpdate:modelValue":e[1]||(e[1]=t=>d.value=t),fit:"","no-parent-event":"","auto-close":""},{default:l(()=>[a(E,null,{default:l(()=>[(u(!0),v(y,null,Q(i.value,t=>(u(),V(F,{key:t,clickable:"",onClick:b=>B(t)},{default:l(()=>[a(G,null,{default:l(()=>[a(q,null,{default:l(()=>[M(T(t),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["modelValue"])])]),n("div",oe,[n("div",se,[a(r,{name:"star",size:"20px",color:"green-6"}),e[8]||(e[8]=n("span",null,"Bewertungen",-1))]),n("div",le,[(u(!0),v(y,null,Q(k.value,t=>(u(),v("div",{key:t.key,class:"rating-item"},[a(P,{modelValue:o.value[t.key],"onUpdate:modelValue":b=>o.value[t.key]=b,label:t.label,icon:t.icon},null,8,["modelValue","onUpdate:modelValue","label","icon"])]))),128))])]),n("div",re,[n("div",ie,[a(r,{name:"notes",size:"20px",color:"green-6"}),e[9]||(e[9]=n("span",null,"Notizen (optional)",-1))]),a(f,{modelValue:o.value.notes,"onUpdate:modelValue":e[3]||(e[3]=t=>o.value.notes=t),label:"Persönliche Notizen oder Beschreibung...",type:"textarea",filled:"",rows:"3",class:"form-input"},{prepend:l(()=>[a(r,{name:"edit_note",color:"green-6"})]),_:1},8,["modelValue"])]),n("div",de,[a(w,{flat:"",label:"Abbrechen",color:"grey-7",onClick:C}),a(w,{type:"submit",unelevated:"",color:"green-6",label:"Sorte hinzufügen",icon:"add",loading:p.value},null,8,["loading"])])]),_:1})]),_:1})]),_:1})])]),_:1}))}};export{he as default};
